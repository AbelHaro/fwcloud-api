<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>models/ipobj.js - FWCloud API REST Documentation</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="icon" href="../assets/favicon.ico">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
                <h1><img src="http://foswiki.soltecsis.com/codedoc/soltecsis-logo1.png" title="FWCloud API REST Documentation"></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 1.0.0</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
                    <h2 class="off-left">APIs</h2>
                    <div id="api-tabview" class="tabview">
                        <ul class="tabs">
                            <li><a href="#api-classes">Classes</a></li>
                            <li><a href="#api-modules">Modules</a></li>
                        </ul>
                
                        <div id="api-tabview-filter">
                            <input type="search" id="api-filter" placeholder="Type to filter APIs">
                        </div>
                
                        <div id="api-tabview-panel">
                            <ul id="api-classes" class="apis classes">
                                <li><a href="../classes/ClusterRouter.html">ClusterRouter</a></li>
                                <li><a href="../classes/FirewallModel.html">FirewallModel</a></li>
                                <li><a href="../classes/FirewallRouter.html">FirewallRouter</a></li>
                                <li><a href="../classes/IpobjsRouter.html">IpobjsRouter</a></li>
                            </ul>
                
                
                            <ul id="api-modules" class="apis modules">
                                <li><a href="../modules/ClusterRouter.html">ClusterRouter</a></li>
                                <li><a href="../modules/FirewallModel.html">FirewallModel</a></li>
                                <li><a href="../modules/FirewallRouter.html">FirewallRouter</a></li>
                                <li><a href="../modules/IpobjsRouter.html">IpobjsRouter</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
                    Show:
                    <label for="api-show-inherited">
                        <input type="checkbox" id="api-show-inherited" checked>
                        Inherited
                    </label>
            
                    <label for="api-show-protected">
                        <input type="checkbox" id="api-show-protected">
                        Protected
                    </label>
            
                    <label for="api-show-private">
                        <input type="checkbox" id="api-show-private">
                        Private
                    </label>
                    <label for="api-show-deprecated">
                        <input type="checkbox" id="api-show-deprecated">
                        Deprecated
                    </label>
            
                </div>
            
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
<h1 class="file-heading">File: models/ipobj.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
var db = require(&#x27;../db.js&#x27;);
var Policy_r__ipobjModel = require(&#x27;../models/policy_r__ipobj&#x27;);
var Policy_r__interfaceModel = require(&#x27;../models/policy_r__interface&#x27;);
var async = require(&#x27;async&#x27;);
var InterfaceModel = require(&#x27;../models/interface&#x27;);
var host_Data = require(&#x27;../models/data_ipobj_host&#x27;);
var interface_Data = require(&#x27;../models/data_interface&#x27;);
var ipobj_Data = require(&#x27;../models/data_ipobj&#x27;);
var Ipobj__ipobjgModel = require(&#x27;../models/ipobj__ipobjg&#x27;);



//create object
var ipobjModel = {};
var tableModel = &quot;ipobj&quot;;

/**
 * Property Logger to manage App logs
 *
 * @property logger
 * @type log4js/app
 * 
 */
var logger = require(&#x27;log4js&#x27;).getLogger(&quot;app&quot;);


//Get ipobj by  id 
ipobjModel.getIpobj = function (fwcloud, id, callback) {
    db.get(function (error, connection) {
        if (error)
            callback(error, null);

        var sql = &#x27;SELECT I.*, T.id id_node, T.id_parent id_parent_node  FROM &#x27; + tableModel + &#x27; I &#x27; +
                &#x27; inner join fwc_tree T on T.id_obj=I.id and T.obj_type=I.type AND (T.fwcloud=&#x27; + connection.escape(fwcloud) + &#x27; OR T.fwcloud IS NULL)&#x27; +
                &#x27; inner join fwc_tree P on P.id=T.id_parent  and P.obj_type&lt;&gt;20 and P.obj_type&lt;&gt;21&#x27; +
                &#x27; WHERE I.id = &#x27; + connection.escape(id) + &#x27; AND (I.fwcloud=&#x27; + connection.escape(fwcloud) + &#x27; OR I.fwcloud IS NULL)&#x27;;

        connection.query(sql, function (error, row) {
            if (error) {
                callback(error, null);
            } else {
                //CHECK IF IPOBJ IS a HOST
                if (row.length &gt; 0) {
                    if (row[0].type === 8) {
                        ipobjModel.getIpobj_Host_Full(fwcloud, id, function (errorhost, datahost) {
                            if (errorhost) {
                                callback(errorhost, null);
                            } else {
                                callback(null, datahost);
                            }
                        });

                    } else
                        callback(null, row);
                } else
                    callback(null, row);


            }
        });
    });
};

//Get ipobj HOST by  id and ALL IPOBjs
ipobjModel.getIpobj_Host_Full = function (fwcloud, id, AllDone) {

    var hosts = [];
    var host_cont = 0;
    var ipobjs_cont = 0;
    var interfaces_cont = 0;

    db.get(function (error, connection) {
        if (error)
            callback(error, null);

        var sqlId = &#x27;&#x27;;
        if (id !== &#x27;&#x27;)
            sqlId = &#x27; AND G.id = &#x27; + connection.escape(id);
        var sql = &#x27;SELECT G.*,  T.id id_node, T.id_parent id_parent_node FROM &#x27; + tableModel + &#x27; G &#x27; +
                &#x27;inner join fwc_tree T on T.id_obj=G.id and T.obj_type=G.type AND (T.fwcloud=&#x27; + connection.escape(fwcloud) + &#x27; OR T.fwcloud IS NULL) &#x27; +
                &#x27; WHERE  (G.fwcloud= &#x27; + connection.escape(fwcloud) + &#x27; OR G.fwcloud is null) &#x27; + sqlId;
        logger.debug(sql);
        connection.query(sql, function (error, rows) {
            if (error)
                callback(error, null);
            else if (rows.length &gt; 0) {
                host_cont = rows.length;
                var row = rows[0];
                async.map(rows, function (row, callback1) {

                    var host_node = new host_Data(row);

                    logger.debug(&quot; ---&gt; DENTRO de HOST: &quot; + row.id + &quot; NAME: &quot; + row.name);
                    var idhost = row.id;
                    host_node.interfaces = new Array();

                    //GET ALL HOST INTERFACES
                    InterfaceModel.getInterfacesHost(idhost, fwcloud, function (error, data_interfaces) {
                        if (data_interfaces.length &gt; 0) {
                            interfaces_cont = data_interfaces.length;

                            async.map(data_interfaces, function (data_interface, callback2) {
                                //GET INTERFACES
                                logger.debug(&quot;--&gt; DENTRO de INTERFACE id:&quot; + data_interface.id + &quot;  Name:&quot; + data_interface.name + &quot;  Type:&quot; + data_interface.interface_type)

                                var interface_node = new interface_Data(data_interface);
                                var idinterface = data_interface.id;

                                interface_node.ipobjs = new Array();

                                //GET ALL INTERFACE OBJECTs
                                ipobjModel.getAllIpobjsInterface(fwcloud, idinterface, function (error, data_ipobjs) {
                                    if (data_ipobjs.length &gt; 0) {
                                        ipobjs_cont = data_ipobjs.length;

                                        async.map(data_ipobjs, function (data_ipobj, callback2) {
                                            //GET OBJECTS
                                            logger.debug(&quot;--&gt; DENTRO de OBJECT id:&quot; + data_ipobj.id + &quot;  Name:&quot; + data_ipobj.name + &quot;  Type:&quot; + data_ipobj.type);

                                            var ipobj_node = new ipobj_Data(data_ipobj);
                                            //AÃ±adimos ipobj a array Interfaces
                                            interface_node.ipobjs.push(ipobj_node);
                                            callback2();
                                        }, //Fin de bucle de IPOBJS
                                                function (err) {

                                                    if (interface_node.ipobjs.length &gt;= ipobjs_cont) {
                                                        host_node.interfaces.push(interface_node);
                                                        if (host_node.interfaces.length &gt;= interfaces_cont) {
                                                            hosts.push(host_node);
                                                            if (hosts.length &gt;= host_cont) {
                                                                AllDone(null, hosts);
                                                            }
                                                        }
                                                    }
                                                }
                                        );
                                    } else {
                                        host_node.interfaces.push(interface_node);
                                        if (host_node.interfaces.length &gt;= interfaces_cont) {
                                            hosts.push(host_node);
                                            if (hosts.length &gt;= host_cont) {
                                                AllDone(null, hosts);
                                            }
                                        }
                                    }
                                }
                                );

                                callback2();
                            }, //Fin de bucle de INTERFACES
                                    function (err) {

//                                        if (host_node.interfaces.length &gt;= interfaces_cont) {
//                                            hosts.push(host_node);
//                                            if (hosts.length &gt;= host_cont) {
//                                                AllDone(null, hosts);
//                                            }
//                                        }
                                    }
                            );
                        } else {
                            hosts.push(host_node);
                            if (hosts.length &gt;= host_cont) {
                                AllDone(null, hosts);
                            }
                        }
                    }
                    );
                    callback1();
                }, //Fin de bucle de GROUPS
                        function (err) {
                            if (hosts.length &gt;= host_cont) {

                                AllDone(null, hosts);
                            }
                        }
                );
            } else {
                AllDone(&quot;&quot;, null);
            }
        });
    });
};
//Get ipobj by  id_fwb
ipobjModel.getIpobj_fwb = function (id_fwb, callback) {
    db.get(function (error, connection) {
        if (error)
            callback(error, null);

        var sql = &#x27;SELECT * FROM &#x27; + tableModel + &#x27; WHERE id_fwb = &#x27; + connection.escape(id_fwb);
        connection.query(sql, function (error, row) {
            if (error)
                callback(error, null);
            else
                callback(null, row);
        });
    });
};

//Get All ipobj by group
ipobjModel.getAllIpobjsGroup = function (fwcloud, idgroup, callback) {

    db.get(function (error, connection) {
        if (error)
            callback(error, null);

        var innergroup = &#x27; INNER JOIN ipobj__ipobjg G on G.ipobj=I.id &#x27;;
        //var sql = &#x27;SELECT * FROM &#x27; + tableModel + &#x27; I &#x27; + innergroup + &#x27; WHERE  G.ipobj_g=&#x27; + connection.escape(idgroup) + &#x27; AND (I.fwcloud=&#x27; + connection.escape(fwcloud) + &#x27; OR I.fwcloud IS NULL) ORDER BY G.id_gi&#x27;;

        var sql = &#x27;SELECT I.*, T.id id_node, T.id_parent id_parent_node  FROM &#x27; + tableModel + &#x27; I &#x27; + innergroup +
                &#x27; inner join fwc_tree T on T.id_obj=I.id and T.obj_type=I.type AND (T.fwcloud=&#x27; + connection.escape(fwcloud) + &#x27; OR T.fwcloud IS NULL)&#x27; +
                &#x27; inner join fwc_tree P on P.id=T.id_parent  and P.obj_type&lt;&gt;20 and P.obj_type&lt;&gt;21&#x27; +
                &#x27; WHERE G.ipobj_g=&#x27; + connection.escape(idgroup) + &#x27; AND (I.fwcloud=&#x27; + connection.escape(fwcloud) + &#x27; OR I.fwcloud IS NULL)&#x27; +
                &#x27; ORDER BY G.id_gi&#x27;;
        logger.debug(sql);

        connection.query(sql, function (error, rows) {
            if (error)
                callback(error, null);
            else
                callback(null, rows);
        });
    });
};

//Get All ipobj by group
ipobjModel.getAllIpobjsInterface = function (fwcloud, idinterface, callback) {

    db.get(function (error, connection) {
        if (error)
            callback(error, null);



        var sql = &#x27;SELECT I.*, T.id id_node, T.id_parent id_parent_node  FROM &#x27; + tableModel + &#x27; I &#x27; +
                &#x27; inner join fwc_tree T on T.id_obj=I.id and T.obj_type=I.type AND (T.fwcloud=&#x27; + connection.escape(fwcloud) + &#x27; OR T.fwcloud IS NULL)&#x27; +
                &#x27; inner join fwc_tree P on P.id=T.id_parent  and P.obj_type&lt;&gt;20 and P.obj_type&lt;&gt;21&#x27; +
                &#x27; WHERE I.interface=&#x27; + connection.escape(idinterface) + &#x27; AND (I.fwcloud=&#x27; + connection.escape(fwcloud) + &#x27; OR I.fwcloud IS NULL)&#x27; +
                &#x27; ORDER BY I.id&#x27;;
        logger.debug(sql);

        connection.query(sql, function (error, rows) {
            if (error)
                callback(error, null);
            else
                callback(null, rows);
        });
    });
};

//Get ipobj by  id and group 
ipobjModel.getIpobjGroup = function (fwcloud, idgroup, id, callback) {
    db.get(function (error, connection) {
        if (error)
            callback(error, null);

        var innergroup = &#x27; T INNER JOIN ipobj__ipobjg G on G.ipobj=T.id &#x27;;
        var sql = &#x27;SELECT * FROM &#x27; + tableModel + innergroup + &#x27; WHERE id = &#x27; + connection.escape(id) + &#x27; AND G.ipobj_g=&#x27; + connection.escape(idgroup) + &#x27; AND (T.fwcloud=&#x27; + connection.escape(fwcloud) + &#x27; OR T.fwcloud IS NULL) &#x27;;

        connection.query(sql, function (error, rows) {
            if (error)
                callback(error, null);
            else
                callback(null, rows[0]);
        });
    });
};

//Get ipobj by name 
ipobjModel.getIpobjName = function (fwcloud, name, callback) {
    db.get(function (error, connection) {
        if (error)
            callback(error, null);
        var namesql = &#x27;%&#x27; + name + &#x27;%&#x27;;

        var sql = &#x27;SELECT I.*, T.id id_node, T.id_parent id_parent_node  FROM &#x27; + tableModel + &#x27; I &#x27; +
                &#x27; inner join fwc_tree T on T.id_obj=I.id and T.obj_type=I.type AND (T.fwcloud=&#x27; + connection.escape(fwcloud) + &#x27; OR T.fwcloud IS NULL)&#x27; +
                &#x27; inner join fwc_tree P on P.id=T.id_parent  and P.obj_type&lt;&gt;20 and P.obj_type&lt;&gt;21&#x27; +
                &#x27; WHERE I.name like  = &#x27; + connection.escape(namesql) + &#x27; AND (I.fwcloud=&#x27; + connection.escape(fwcloud) + &#x27; OR I.fwcloud IS NULL)&#x27;;

        //var sql = &#x27;SELECT * FROM &#x27; + tableModel + &#x27; WHERE name like  &#x27; + connection.escape(namesql) + &#x27; AND (T.fwcloud=&#x27; + connection.escape(fwcloud) + &#x27; OR T.fwcloud IS NULL) &#x27;;

        connection.query(sql, function (error, row) {
            if (error)
                callback(error, null);
            else
                callback(null, row);
        });
    });
};



//Add new ipobj from user
ipobjModel.insertIpobj = function (ipobjData, callback) {
    db.get(function (error, connection) {
        if (error)
            callback(error, null);
        connection.query(&#x27;INSERT INTO &#x27; + tableModel + &#x27; SET ?&#x27;, ipobjData, function (error, result) {
            if (error) {
                callback(error, null);
            } else {
                if (result.affectedRows &gt; 0) {
                    //devolvemos la Ãºltima id insertada
                    callback(null, {result: true, &quot;insertId&quot;: result.insertId});
                } else
                    callback(null, {result: false, &quot;insertId&quot;: &#x27;&#x27;});
            }
        });
    });
};

//Update ipobj from user
ipobjModel.updateIpobj = function (ipobjData, callback) {

    db.get(function (error, connection) {
        if (error)
            callback(error, null);
        var sql = &#x27;UPDATE &#x27; + tableModel + &#x27; SET &#x27; +
                &#x27;fwcloud = &#x27; + connection.escape(ipobjData.fwcloud) + &#x27;,&#x27; +
                &#x27;interface = &#x27; + connection.escape(ipobjData.interface) + &#x27;,&#x27; +
                &#x27;name = &#x27; + connection.escape(ipobjData.name) + &#x27;,&#x27; +
                &#x27;type = &#x27; + connection.escape(ipobjData.type) + &#x27;,&#x27; +
                &#x27;protocol = &#x27; + connection.escape(ipobjData.protocol) + &#x27;,&#x27; +
                &#x27;address = &#x27; + connection.escape(ipobjData.address) + &#x27;,&#x27; +
                &#x27;netmask = &#x27; + connection.escape(ipobjData.netmask) + &#x27;,&#x27; +
                &#x27;diff_serv = &#x27; + connection.escape(ipobjData.diff_serv) + &#x27;,&#x27; +
                &#x27;ip_version = &#x27; + connection.escape(ipobjData.ip_version) + &#x27;,&#x27; +
                &#x27;code = &#x27; + connection.escape(ipobjData.code) + &#x27;,&#x27; +
                &#x27;tcp_flags_mask = &#x27; + connection.escape(ipobjData.tcp_flags_mask) + &#x27;,&#x27; +
                &#x27;tcp_flags_settings = &#x27; + connection.escape(ipobjData.tcp_flags_settings) + &#x27;,&#x27; +
                &#x27;range_start = &#x27; + connection.escape(ipobjData.range_start) + &#x27;,&#x27; +
                &#x27;range_end = &#x27; + connection.escape(ipobjData.range_end) + &#x27;,&#x27; +
                &#x27;source_port_start = &#x27; + connection.escape(ipobjData.source_port_start) + &#x27;,&#x27; +
                &#x27;source_port_end = &#x27; + connection.escape(ipobjData.source_port_end) + &#x27;,&#x27; +
                &#x27;destination_port_start = &#x27; + connection.escape(ipobjData.destination_port_start) + &#x27;,&#x27; +
                &#x27;destination_port_end = &#x27; + connection.escape(ipobjData.destination_port_end) + &#x27;,&#x27; +
                &#x27;options = &#x27; + connection.escape(ipobjData.options) + &#x27;,&#x27; +
                &#x27;comment = &#x27; + connection.escape(ipobjData.comment) + &#x27; &#x27; +
                &#x27; WHERE id = &#x27; + ipobjData.id + &#x27; AND fwcloud=&#x27; + connection.escape(ipobjData.fwcloud);
        logger.debug(sql);
        connection.query(sql, function (error, result) {
            if (error) {
                callback(error, null);
            } else {
                if (result.affectedRows &gt; 0) {
                    callback(null, {&quot;result&quot;: true});
                } else {
                    callback(null, {&quot;result&quot;: false});
                }
            }
        });
    });
};

//FALTA DELETE INTERFACE y OBJETOS de HOST
//Remove ipobj with id to remove
ipobjModel.deleteIpobj = function (id, type, fwcloud, callback) {
    //Search IPOBJ in RULES
    this.searchIpobjInRules(id, type, fwcloud, function (error, data) {
        if (error) {
            logger.debug(error);
            callback(error, null);
        } else {
            //CHECK RESULTS
            if (data.result) {
                logger.debug(&quot;RESTRICTED IPOBJ: &quot; + id + &quot;  Type: &quot; + type + &quot;  Fwcloud: &quot; + fwcloud);
                callback(null, {&quot;result&quot;: false, &quot;msg&quot;: &quot;Restricted&quot;, &quot;restrictions&quot;: data.search});
            } else {
                db.get(function (error, connection) {
                    if (error)
                        callback(error, null);
                    var sql = &#x27;DELETE FROM &#x27; + tableModel + &#x27; WHERE id = &#x27; + connection.escape(id) + &#x27; AND fwcloud=&#x27; + connection.escape(fwcloud) + &#x27; AND type=&#x27; + connection.escape(type);
                    logger.debug(sql);
                    connection.query(sql, function (error, result) {
                        if (error) {
                            logger.debug(error);
                            callback(error, null);
                        } else {
                            if (result.affectedRows &gt; 0) {
                                logger.debug(&quot;OK DELETED IPOBJ: &quot; + id + &quot;  Type: &quot; + type + &quot;  Fwcloud: &quot; + fwcloud);
                                callback(null, {&quot;result&quot;: true, &quot;msg&quot;: &quot;deleted&quot;});
                            } else {
                                callback(null, {&quot;result&quot;: false, &quot;msg&quot;: &quot;notExist&quot;});
                            }
                        }
                    });
                });
            }
        }
    });
};


//check if IPOBJ Exists in any Group
ipobjModel.checkIpobjInGroup = function (ipobj, type, fwcloud, callback) {

    logger.debug(&quot;CHECK DELETING FROM GROUP ipobj:&quot; + ipobj + &quot; Type:&quot; + type + &quot;  fwcloud:&quot; + fwcloud);
    db.get(function (error, connection) {

        var sql = &#x27;SELECT count(*) as n FROM &#x27; + tableModel + &#x27; I &#x27; +
                &#x27; INNER JOIN ipobj__ipobjg G on G.ipobj=I.id &#x27; +
                &#x27; WHERE I.id=&#x27; + connection.escape(ipobj) + &#x27; AND I.type=&#x27; + connection.escape(type) + &#x27; AND I.fwcloud=&#x27; + connection.escape(fwcloud);
        logger.debug(sql);
        connection.query(sql, function (error, rows) {
            if (!error) {
                if (rows.length &gt; 0) {
                    if (rows[0].n &gt; 0) {
                        logger.debug(&quot;ALERT DELETING ipobj IN GROUP:&quot; + ipobj + &quot; type: &quot; + type + &quot; fwcloud:&quot; + fwcloud + &quot; --&gt; FOUND IN &quot; + rows[0].n + &quot; GROUPS&quot;);
                        callback(null, {&quot;result&quot;: true});
                    } else {
                        callback(null, {&quot;result&quot;: false});
                    }
                } else
                    callback(null, {&quot;result&quot;: false});
            } else {
                logger.error(error);
                callback(null, {&quot;result&quot;: false});
            }
        });
    });

};

/* Search where is used IPOBJ in RULES  */
ipobjModel.searchIpobjInRules = function (id, type, fwcloud, callback) {
    //SEARCH IPOBJ IN RULES
    Policy_r__ipobjModel.searchIpobjInRule(id, type, fwcloud, function (error, data_ipobj) {
        if (error) {
            callback(error, null);
        } else {
            //SEARCH IPOBJ GROUP IN RULES
            Policy_r__ipobjModel.searchIpobjGroupInRule(id, type, fwcloud, function (error, data_grouprule) {
                if (error) {
                    callback(error, null);
                } else {
                    //SEARCH IPOBJ IN GROUPS
                    Ipobj__ipobjgModel.searchIpobjGroup(id, type, fwcloud, function (error, data_group) {
                        if (error) {
                            callback(error, null);
                        } else {
                            //SEARCH INTERFACES UNDER IPOBJ HOST IN RULES  &#x27;O&#x27;  POSITIONS
                            Policy_r__ipobjModel.searchInterfacesIpobjHostInRule(id, type, fwcloud, function (error, data_interfaces) {
                                if (error) {
                                    callback(error, null);
                                } else {
                                    //SEARCH INTERFACES ABOVE IPOBJ  IN RULES  &#x27;O&#x27;  POSITIONS
                                    Policy_r__ipobjModel.searchInterfacesAboveIpobjInRule(id, type, fwcloud, function (error, data_interfaces_above) {
                                        if (error) {
                                            callback(error, null);
                                        } else {
                                            //SEARCH INTERFACES WITH IPOBJ UNDER  IN RULES  &#x27;I&#x27;  POSITIONS
                                            Policy_r__interfaceModel.searchInterfacesInRule(id, fwcloud, function (error, data_interfaces_f) {
                                                if (error) {
                                                    callback(error, null);
                                                } else {
                                                    //SEARCH IF IPOBJ UNDER INTERFACES UNDER IPOBJ HOST Has HOST IN RULES &#x27;O&#x27; POSITIONS                                            
                                                    Policy_r__ipobjModel.searchIpobjInterfacesIpobjHostInRule(id, type, fwcloud, function (error, data_ipobj_host) {
                                                        if (error) {
                                                            callback(error, null);
                                                        } else {
                                                            //SEARCH IF IPOBJ UNDER INTERFACES UNDER IPOBJ HOST Has HOST IN RULES &#x27;O&#x27; POSITIONS                                            
                                                            Policy_r__ipobjModel.searchIpobjInterfacesIpobjInRule(id, type, fwcloud, function (error, data_ipobj_ipobj) {
                                                                if (error) {
                                                                    callback(error, null);
                                                                } else {
                                                                    if (data_ipobj.found !== &quot;&quot; || data_grouprule.found !== &quot;&quot; || data_group.found !== &quot;&quot;
                                                                            || data_interfaces.found !== &quot;&quot; || data_ipobj_host.found !== &quot;&quot; || data_ipobj_ipobj.found !== &quot;&quot;
                                                                            || data_interfaces_f.found !== &quot;&quot;) {
                                                                        callback(null, {&quot;result&quot;: true, &quot;msg&quot;: &quot;IPOBJ FOUND&quot;, &quot;search&quot;:
                                                                                    {&quot;IpobjInRules&quot;: data_ipobj, &quot;GroupInRules&quot;: data_grouprule, &quot;IpobjInGroup&quot;: data_group,
                                                                                        &quot;InterfacesIpobjInRules&quot;: data_interfaces, &quot;InterfacesFIpobjInRules&quot;: data_interfaces_f,
                                                                                        &quot;InterfacesAboveIpobjInRules&quot;: data_interfaces_above,
                                                                                        &quot;HostIpobjInterfacesIpobjInRules&quot;: data_ipobj_host, &quot;IpobjInterfacesIpobjInRules&quot;: data_ipobj_ipobj
                                                                                        }});
                                                                    } else {
                                                                        callback(null, {&quot;result&quot;: false, &quot;msg&quot;: &quot;IPOBJ NOT FOUND&quot;, &quot;search&quot;: {
                                                                                &quot;IpobjInRules&quot;: &quot;&quot;, &quot;GroupInRules&quot;: &quot;&quot;,
                                                                                &quot;IpobjInGroup&quot;: &quot;&quot;, &quot;InterfacesIpobjInRules&quot;: &quot;&quot;, &quot;InterfacesFIpobjInRules&quot;: &quot;&quot;,
                                                                                &quot;InterfacesAboveIpobjInRules&quot;: &quot;&quot;,
                                                                                &quot;HostIpobjInterfacesIpobjInRules&quot;: &quot;&quot;, &quot;IpobjInterfacesIpobjInRules&quot;: &quot;&quot;}});
                                                                    }
                                                                }
                                                            });
                                                        }
                                                    });
                                                }
                                            });
                                        }
                                    });
                                }
                            });
                        }
                    });
                }
            });
        }

    });
};

/* Search where is used IPOBJ  */
ipobjModel.searchIpobj = function (id, type, fwcloud, callback) {
    //SEARCH IPOBJ IN RULES
    Policy_r__ipobjModel.searchIpobjInRule(id, type, fwcloud, function (error, data_ipobj) {
        if (error) {
            callback(error, null);
        } else {
            //SEARCH IPOBJ IN GROUPS
            Ipobj__ipobjgModel.searchIpobjGroup(id, type, fwcloud, function (error, data_group) {
                if (error) {
                    callback(error, null);
                } else {
                    //SEARCH IPOBJ UNDER INTERFACES UNDER IPOBJ HOST IN RULES &#x27;O&#x27; POSITONS
                    Policy_r__ipobjModel.searchIpobjInterfaces(id, type, fwcloud, function (error, data_ipobj_interfaces) {
                        if (error) {
                            callback(error, null);
                        } else {

                            //logger.debug(data_ipobj);
                            if (data_ipobj.found !== &quot;&quot; || data_group.found !== &quot;&quot; || data_ipobj_interfaces.found !== &quot;&quot;) {
                                callback(null, {&quot;result&quot;: true, &quot;msg&quot;: &quot;IPOBJ FOUND&quot;, &quot;search&quot;: {
                                        &quot;IpobjInRules&quot;: data_ipobj, &quot;IpobjInGroup&quot;: data_group, &quot;IpobjInterfaces&quot;: data_ipobj_interfaces}});
                            } else {
                                callback(null, {&quot;result&quot;: false, &quot;msg&quot;: &quot;IPOBJ NOT FOUND&quot;, &quot;search&quot;: {
                                        &quot;IpobjInRules&quot;: &quot;&quot;, &quot;IpobjInGroup&quot;: &quot;&quot;, &quot;IpobjInterfaces&quot;: &quot;&quot;}});
                            }

                        }
                    });
                }
            });
        }
    });

};
//Export the object
module.exports = ipobjModel;
    </pre>
</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
