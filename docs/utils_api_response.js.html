<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>utils/api_response.js - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="module-api_response.html#~respModel">respModel</a></li><li><a href="module-Cluster-ClusterRouter.html">ClusterRouter</a></li><li><a href="module-Compile-CompileRouter.html">CompileRouter</a></li><li><a href="module-FirewallExport-FirewallModel.html">FirewallModel</a></li><li><a href="module-Firewall-FirewallRouter.html">FirewallRouter</a></li><li><a href="module-Fwcloud.html#~FwcloudModel">FwcloudModel</a></li><li><a href="module-Fwcloud-FwcloudRouter.html">FwcloudRouter</a></li><li><a href="module-Ipobjs-IpobjsRouter.html">IpobjsRouter</a></li></ul><h3>Modules</h3><ul><li><a href="module-api_response.html">api_response</a><ul class='methods'><li data-type='method'><a href="module-api_response.html#~getJson">getJson</a></li><li data-type='method'><a href="module-api_response.html#~getMsgCodeResp">getMsgCodeResp</a></li></ul></li><li><a href="module-Cluster.html">Cluster</a><ul class='methods'><li data-type='method'><a href="module-Cluster.html#~getclusters">getclusters</a></li></ul></li><li><a href="module-Compile.html">Compile</a></li><li></li><li><a href="module-Firewall.html">Firewall</a><ul class='methods'><li data-type='method'><a href="module-Firewall.html#~AddFirewall">AddFirewall</a></li><li data-type='method'><a href="module-Firewall.html#~DeleteFirewall">DeleteFirewall</a></li><li data-type='method'><a href="module-Firewall.html#~getFirewallByUser">getFirewallByUser</a></li><li data-type='method'><a href="module-Firewall.html#~getFirewallByUser_and_Cloud">getFirewallByUser_and_Cloud</a></li><li data-type='method'><a href="module-Firewall.html#~getFirewallByUser_and_Cluster">getFirewallByUser_and_Cluster</a></li><li data-type='method'><a href="module-Firewall.html#~getFirewallByUser_and_Id">getFirewallByUser_and_Id</a></li><li data-type='method'><a href="module-Firewall.html#~getLockedStatusFirewallByUser_and_ID_V2">getLockedStatusFirewallByUser_and_ID_V2</a></li><li data-type='method'><a href="module-Firewall.html#~UpdateFirewall">UpdateFirewall</a></li></ul></li><li><a href="module-FirewallExport.html">FirewallExport</a></li><li><a href="module-Fwcloud.html">Fwcloud</a><ul class='methods'><li data-type='method'><a href="module-Fwcloud.html#~AddFwcloud">AddFwcloud</a></li><li data-type='method'><a href="module-Fwcloud.html#~DeleteFwcloud">DeleteFwcloud</a></li><li data-type='method'><a href="module-Fwcloud.html#~deleteFwcloud">deleteFwcloud</a></li><li data-type='method'><a href="module-Fwcloud.html#~getFwcloud">getFwcloud</a></li><li data-type='method'><a href="module-Fwcloud.html#~getFwcloud">getFwcloud</a></li><li data-type='method'><a href="module-Fwcloud.html#~getFwcloudByUser">getFwcloudByUser</a></li><li data-type='method'><a href="module-Fwcloud.html#~getFwcloudByUser_and_ID_V2">getFwcloudByUser_and_ID_V2</a></li><li data-type='method'><a href="module-Fwcloud.html#~getFwcloudLockedAccess">getFwcloudLockedAccess</a></li><li data-type='method'><a href="module-Fwcloud.html#~getFwcloudLockedTimeout">getFwcloudLockedTimeout</a></li><li data-type='method'><a href="module-Fwcloud.html#~getLockedStatusFwcloudByUser_and_ID">getLockedStatusFwcloudByUser_and_ID</a></li><li data-type='method'><a href="module-Fwcloud.html#~insertFwcloud">insertFwcloud</a></li><li data-type='method'><a href="module-Fwcloud.html#~UpdateFwcloud">UpdateFwcloud</a></li><li data-type='method'><a href="module-Fwcloud.html#~updateFwcloud">updateFwcloud</a></li><li data-type='method'><a href="module-Fwcloud.html#~updateFwcloudLock">updateFwcloudLock</a></li><li data-type='method'><a href="module-Fwcloud.html#~UpdateFwcloudLock">UpdateFwcloudLock</a></li><li data-type='method'><a href="module-Fwcloud.html#~UpdateFwcloudUnlock">UpdateFwcloudUnlock</a></li><li data-type='method'><a href="module-Fwcloud.html#~updateFwcloudUnlock">updateFwcloudUnlock</a></li></ul></li><li></li><li><a href="module-ipobj%2520group.html">ipobj group</a></li><li><a href="module-Ipobjs.html">Ipobjs</a><ul class='methods'><li data-type='method'><a href="module-Ipobjs.html#~DeleteIpobj">DeleteIpobj</a></li><li data-type='method'><a href="module-Ipobjs.html#~getIpobjById">getIpobjById</a></li><li data-type='method'><a href="module-Ipobjs.html#~NewIpobj">NewIpobj</a></li><li data-type='method'><a href="module-Ipobjs.html#~SearchIpobjWhereUsed">SearchIpobjWhereUsed</a></li><li data-type='method'><a href="module-Ipobjs.html#~UpdateIpobj">UpdateIpobj</a></li></ul></li><li><a href="module-OpenVPN.html">OpenVPN</a></li><li></li></ul><h3>Global</h3><ul><li><a href="global.html#api_resp">api_resp</a></li><li><a href="global.html#logger">logger</a></li><li><a href="global.html#Policy_cModel">Policy_cModel</a></li><li><a href="global.html#Policy_rModel">Policy_rModel</a></li><li><a href="global.html#RuleCompile">RuleCompile</a></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">utils/api_response.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Module to manage responses
 * &lt;br>BASE ROUTE CALL: &lt;b>/firewalls&lt;/b>
 *
 * @module api_response
 * 
 * 
 */

/**
 * Class to manage firewalls routing
 *
 * @class respModel
 * 
 */

/**
 * Property Model to manage response Data
 *
 * @property respModel
 * @type ../../utils/api_response
 * 
 * 
 */
var respModel = {};

//const VError = require('verror').VError;
//const WError = require('verror').WError;

/**
 * Property ACR_ERROR
 *
 * @property ACR_ERROR
 * @type String
 */
respModel.ACR_ERROR = 'ACR_ERROR';
/**
 * Property ACR_OK
 *
 * @property ACR_OK
 * @type String
 */
respModel.ACR_OK = 'ACR_OK';
/**
 * Property reACR_NOTEXISTsp
 *
 * @property ACR_NOTEXIST
 * @type String
 */
respModel.ACR_NOTEXIST = 'ACR_NOTEXIST';
/**
 * Property resp
 *
 * @property ACR_MISSING
 * @type String
 */
respModel.ACR_MISSING = 'ACR_MISSING';
/**
 * Property ACR_DELETED_OK
 *
 * @property ACR_DELETED_OK
 * @type String
 */
respModel.ACR_DELETED_OK = 'ACR_DELETED_OK';
/**
 * Property ACR_RESTRICTED
 *
 * @property ACR_RESTRICTED
 * @type String
 */
respModel.ACR_RESTRICTED = 'ACR_RESTRICTED';
/**
 * Property ACR_INSERTED_OK
 *
 * @property ACR_INSERTED_OK
 * @type String
 */
respModel.ACR_INSERTED_OK = 'ACR_INSERTED_OK';
/**
 * Property ACR_UPDATED_OK
 *
 * @property ACR_UPDATED_OK
 * @type String
 */
respModel.ACR_UPDATED_OK = 'ACR_UPDATED_OK';
/**
 * Property ACR_DATA_ERROR
 *
 * @property ACR_DATA_ERROR
 * @type String
 */
respModel.ACR_DATA_ERROR = 'ACR_DATA_ERROR';
/**
 * Property ACR_NOT_ALLOWED
 *
 * @property ACR_NOT_ALLOWED
 * @type String
 */
respModel.ACR_NOT_ALLOWED = 'ACR_NOT_ALLOWED';
/**
 * Property ACR_PARAM_ERROR
 *
 * @property ACR_PARAM_ERROR
 * @type String
 */
respModel.ACR_PARAM_ERROR = 'ACR_PARAM_ERROR';

/**
 * Property ACR_ACCESS_ERROR
 *
 * @property ACR_ACCESS_ERROR
 * @type String
 */
respModel.ACR_ACCESS_ERROR = 'ACR_ACCESS_ERROR';

/**
 * Property ACR_SESSION_ERROR
 *
 * @property ACR_SESSION_ERROR
 * @type String
 */
respModel.ACR_SESSION_ERROR = 'ACR_SESSION_ERROR';

/**
 * Property ACR_ACCESS_LOCKED
 *
 * @property ACR_ACCESS_LOCKED
 * @type String
 */
respModel.ACR_ACCESS_LOCKED = 'ACR_ACCESS_LOCKED';

/**
 * Property ACR_COMPILED_OK
 *
 * @property ACR_COMPILED_OK
 * @type String
 */
respModel.ACR_COMPILED_OK = 'ACR_COMPILED_OK';

/**
 * Property ACR_CONFIRM_ASK
 *
 * @property ACR_CONFIRM_ASK
 * @type String
 */
respModel.ACR_CONFIRM_ASK = 'ACR_CONFIRM_ASK';

/**
 * Property ACR_ALREADY_EXISTS
 *
 * @property ACR_ALREADY_EXISTS
 * @type String
 */
respModel.ACR_ALREADY_EXISTS = 'ACR_ALREADY_EXISTS';

/**
 * Property Logger to manage App logs
 *
 * @attribute logger
 * @type log4js/app
 * 
 */
var logger = require('log4js').getLogger("app");

/* para control de errores
 const errReqFail = new Error('Request failed');
 const errReqStatus = new VError(errReqFail, 'Unexpected status code "%s"', '500');
 const errReq = new WError(errReqStatus, 'Internal error');
 
 console.error(errReq.message); //Internal error:
 // get some real data for logging
 console.info(errReq.toString()); //
 */

/**
 * ### GET JSON RESONSE
 * 
 * @method getJson
 * 
 * @param {Object} data  Data response from Call
 * @param {String} respCode  Response code
 * @param {String} custom_response custom Message from Call
 * @param {String} custom_obj  Custon name of object
 * @param {Object} error Object Error
 * @param {Callback} callback function(jsonresp)  
 * 
 * @return {JSON} Returns Json result
 * @example 
 * #### JSON RESPONSE :
 *    
 *      {"response": {
 *        "respStatus": true | false,
 *        "respCode": "ACR_CODE",
 *        "respCodeMsg": "",
 *        "respMsg": "",
 *        "errorCode": "",
 *        "errorMsg": ""
 *      },
 *      "data": {}
 *      };
 *       
 */
respModel.getJson = function (data, respCode, custom_response, custom_obj, error, callback) {
    var resp_json = "";
    var error_code = "";
    var error_msg = "";


    if (error) {
        error_code = error.code;
        error_msg = error.message;
    }
    if (data === null)
        data = {};
    this.getMsgCodeResp(respCode, custom_obj, error, function (respStatus, respMsg) {
        resp_json = {"response": {
                "respStatus": respStatus,
                "respCode": respCode,
                "respCodeMsg": respMsg,
                "respMsg": custom_response,
                "errorCode": error_code,
                "errorMsg": error_msg},
            "data": data};

        // If error, then log it.
        if (error || respCode.search("ERROR")>=0)
            logger.debug(resp_json);

        callback(resp_json);
    });


};

/**
 * ### GET Message from Response Code
 * 
 * @method getMsgCodeResp
 * 
 * @param {String} respCode  Response code
 * @param {String} custom_response custom Message from Call
 * @param {String} custom_obj  Custon name of object
 * @param {Object} error Object Error
 * @param {Callback} callback function(status,message)  
 * 
 * @return {boolean, String} Returns Status and message response
 */
respModel.getMsgCodeResp = function (respCode, custom_obj, error, callback) {
    var msg = "";
    var status = false;

    switch (respCode) {
        case this.ACR_ERROR:
            status = false;
            if (error) {
                switch (error.code) {
                    case 'ER_NO_REFERENCED_ROW_2' :
                        msg = 'foreign Data reference error';
                        break;
                    case 'ER_DUP_ENTRY':
                        msg = 'Duplicated Data';
                        break;
                    default:
                        msg = "Internal Error";
                }
            }
            break;
        case this.ACR_OK:
            status = true;
            msg = "Ok";
            break;
        case this.ACR_NOTEXIST:
            status = false;
            msg = custom_obj + " not exist";
            break;
        case this.ACR_MISSING:
            status = false;
            msg = custom_obj + " not exist";
            break;
        case this.ACR_DATA_ERROR:
            status = false;
            msg = custom_obj + " Data error";
            break;
        case this.ACR_DELETED_OK:
            status = true;
            msg = custom_obj + " delete success";
            break;
        case this.ACR_INSERTED_OK:
            status = true;
            msg = custom_obj + " insert success";
            break;
        case this.ACR_UPDATED_OK:
            status = true;
            msg = custom_obj + " update success";
            break;
        case this.ACR_RESTRICTED:
            status = false;
            msg = custom_obj + " restricted";
            break;
        case this.ACR_NOT_ALLOWED:
            status = false;
            msg = custom_obj + " not allowed";
            break;
        case this.ACR_PARAM_ERROR:
            status = false;
            msg = custom_obj + " param error";
            break;
        case this.ACR_ACCESS_ERROR:
            status = false;
            msg = custom_obj + " Access not allowed by user access";
            break;
        case this.ACR_ACCESS_LOCKED:
            status = false;
            msg = custom_obj + " Access not allowed by lock status";
            break;
        case this.ACR_COMPILED_OK:
            status = true;
            msg = custom_obj + " compile success";
            break;    
        case this.ACR_CONFIRM_ASK:
            status = true;
            msg = custom_obj + " Confirmation ask";
            break;    
        default:
            status = false;
            msg = "unknown error";
    }

    callback(status, msg);
};



//Export the object
module.exports = respModel;</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Mon Jan 28 2019 22:45:33 GMT+0100 (GMT+01:00) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>


</body>
</html>
