# Changelog
All notable changes to this project will be documented in this file.

The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/),
and this project adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html).

## [Unreleased]
### Added
- Configuration parameters for socket.io pingInterval and pingTimeout.
- Send heartbeats through socket.io in FWCloud import/export operations.
- For SSH connections detect if we are using the `root` user and don't use `sudo` in such cases.
- Improve session check in socket.io connection establishment.
- API call `PUT /ping`.
- Improved SSH errors management.
- Include rule metadata (color, group, group color, etc.) in the comment of rule compilation. Thanks to this it is possible to restore these metadata information when we import a FWCloud firewall using `iptables-save import feature`.
- API call `PUT /iptables-save/import`: Import iptables-save data into an existing firewall.
- API call `PUT /iptables-save/export`: Get iptables-save data exit from a FWCloud managed firewall.
- Upgrade to Socket.IO v3. Upgraded npm module socket.io from 2.3.0 to 3.0.4.
- By default listen to localhost.

### Fixed
- Set the mysqldump node module format option to false for avoid long high CPU usage in backups of databases with lot of registers.
- Multiport module, up to 15 ports limit control.
- Bug in session expiration.
- fwcloud-updater doesn't process update requests (for example, PUT /updates/ui) when all request headers are forwarded. Forward only the cookie header, required for the authentication middleware of the fwcloud-updater.
- Log detailed information for websocket connection/disconnection.
- Disable etag in express for avoid the problem explained in the http-application.ts file.
- Bug in autodiscover when the `ip a` command returns interfaces with name like this one: `ens193.40@ens193:` In such cases the interface name must be the string preceding the `@` character.

### Changed
- Set the maximum size of accepted data for BodyParser to 2MB.
- Disable confirmation token for `PUT /ping` API call.
- Clean firewall policy before iptables-save import.
- Don't add comment in firewall rules generated by iptables-save import procedure.

### Security
- Updated npm module highlight.js from 9.18.0 to 9.18.5.
- Updated npm module ini from 1.3.5 to 1.3.7.
- Updated npm module axios from 0.21.0 to 0.21.1.


## [1.0.1] 
### Added
- Log format for http.log.
- Rename log file from 'fwcloud.log' to 'api.log'.
- Unify log format with all other applications (fwcloud-updater and fwcloud-websrv) logs format.
- Store pid in .pid file.
- Npm script for stop process using the pid stored in .pid file.
- SGTERM and SIGINT signal handlers.
- Implement API call for FWCloud Websrv updates (PUT /updates/websrv).
- Ignore self signed certificate for fwcloud-updater.
